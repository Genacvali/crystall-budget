{% extends "base.html" %}
{% block title %}–ò—Å—Ç–æ—á–Ω–∏–∫–∏ ‚Äî CrystalBudget{% endblock %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
  <h3 class="m-0">–ò—Å—Ç–æ—á–Ω–∏–∫–∏ –¥–æ—Ö–æ–¥–æ–≤</h3>
</div>

<div class="card card-body mb-3">
  <form method="POST" action="{{ url_for('sources_add') }}">
    <div class="row g-3">
      <div class="col-md-6">
        <label class="form-label">–ù–∞–∑–≤–∞–Ω–∏–µ</label>
        <input class="form-control" name="name" placeholder="–ó–ü, –ê–≤–∞–Ω—Å, –î–µ–∫—Ä–µ—Ç–Ω—ã–µ" required>
      </div>
      <div class="col-md-4">
        <label class="form-label">–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</label>
        <select class="form-select" name="is_default">
          <option value="0">–ù–µ—Ç</option>
          <option value="1">–î–∞</option>
        </select>
      </div>
      <div class="col-md-2 d-grid">
        <label class="form-label d-none d-md-block">&nbsp;</label>
        <button class="btn btn-success">
          <i class="bi bi-plus-lg me-1"></i> –î–æ–±–∞–≤–∏—Ç—å
        </button>
      </div>
    </div>
  </form>
</div>

<div class="table-responsive">
  <table class="table align-middle">
    <thead class="table-light">
      <tr>
        <th>–ù–∞–∑–≤–∞–Ω–∏–µ</th>
        <th>–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é</th>
        <th class="text-end">–î–µ–π—Å—Ç–≤–∏—è</th>
      </tr>
    </thead>
    <tbody>
      {% for s in sources %}
      <tr>
        <td>{{ s.name }}</td>
        <td>{{ '–î–∞' if s.is_default else '–ù–µ—Ç' }}</td>
        <td class="text-end">
          <form class="d-inline" method="POST" action="{{ url_for('sources_update', source_id=s.id) }}">
            <input type="hidden" name="name" value="{{ s.name }}">
            <input type="hidden" name="is_default" value="{{ 1 if not s.is_default else 0 }}">
            <button class="btn btn-sm btn-outline-primary">
              {{ '–°–¥–µ–ª–∞—Ç—å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º' if not s.is_default else '–£–±—Ä–∞—Ç—å –¥–µ—Ñ–æ–ª—Ç' }}
            </button>
          </form>
          <form class="d-inline" method="POST" action="{{ url_for('sources_delete', source_id=s.id) }}">
            <button class="btn btn-sm btn-outline-danger" onclick="return confirm('–£–¥–∞–ª–∏—Ç—å –∏—Å—Ç–æ—á–Ω–∏–∫ ¬´{{ s.name }}¬ª?\n\n–í–Ω–∏–º–∞–Ω–∏–µ: –£–¥–∞–ª–µ–Ω–∏–µ –Ω–µ–≤–æ–∑–º–æ–∂–Ω–æ, –µ—Å–ª–∏ —Å –∏—Å—Ç–æ—á–Ω–∏–∫–æ–º —Å–≤—è–∑–∞–Ω—ã –∑–∞–ø–∏—Å–∏ –¥–æ—Ö–æ–¥–æ–≤ –∏–ª–∏ –ø—Ä–∏–≤—è–∑–∫–∏ –∫ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º.')">
              –£–¥–∞–ª–∏—Ç—å
            </button>
          </form>
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>

{% if not sources %}
<div class="text-center py-5">
  <div class="mb-4">
    <i class="bi bi-piggy-bank display-1 text-muted opacity-50"></i>
  </div>
  <h4 class="text-muted mb-3">–ü–æ–∫–∞ –Ω–µ—Ç –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤ –¥–æ—Ö–æ–¥–∞</h4>
  <div class="mb-4">
    <p class="text-muted mb-3">
      <strong>üí∞ –ò—Å—Ç–æ—á–Ω–∏–∫–∏ –ø–æ–º–æ–≥–∞—é—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å, –æ—Ç–∫—É–¥–∞ –ø—Ä–∏—Ö–æ–¥—è—Ç –¥–µ–Ω—å–≥–∏</strong>
    </p>
    <div class="row justify-content-center">
      <div class="col-lg-6">
        <div class="text-muted small text-start">
          <p class="mb-2"><strong>–ü—Ä–∏–º–µ—Ä—ã –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤:</strong></p>
          <div class="d-flex flex-wrap justify-content-center gap-2">
            <span class="badge bg-light text-dark">üíº –û—Å–Ω–æ–≤–Ω–∞—è —Ä–∞–±–æ—Ç–∞</span>
            <span class="badge bg-light text-dark">üìà –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏</span>
            <span class="badge bg-light text-dark">üè† –ê—Ä–µ–Ω–¥–∞</span>
            <span class="badge bg-light text-dark">üí∞ –ü–æ–¥—Ä–∞–±–æ—Ç–∫–∞</span>
            <span class="badge bg-light text-dark">üéÅ –ü–æ–¥–∞—Ä–∫–∏</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  <button class="btn btn-primary btn-lg" onclick="document.querySelector('input[name=name]')?.focus()">
    <i class="bi bi-plus-lg me-2"></i> –°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫
  </button>
  <div class="mt-3">
    <small class="text-muted">üí° –°–æ–≤–µ—Ç: –æ—Ç–º–µ—Ç—å—Ç–µ –æ–¥–∏–Ω –∏—Å—Ç–æ—á–Ω–∏–∫ –∫–∞–∫ "–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é" –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –¥–æ—Ö–æ–¥–æ–≤</small>
  </div>
</div>
{% endif %}
{% endblock %}
# Задай здесь свой алиас: например, 203-0-113-10.sslip.io
{$HOSTNAME} {
  encode zstd gzip
  reverse_proxy app:3000
  
  # Кэширование статических ресурсов
  @static {
    path /_next/static/* /favicon.ico *.png *.jpg *.jpeg *.gif *.svg *.css *.js
  }
  header @static Cache-Control "public, max-age=31536000, immutable"
  
  # PWA файлы не кэшируем
  @pwa {
    path /manifest.webmanifest /sw.js /service-worker.js
  }
  header @pwa Cache-Control "no-cache, no-store, must-revalidate"
  
  # Security headers
  header {
    X-Content-Type-Options nosniff
    X-Frame-Options DENY
    X-XSS-Protection "1; mode=block"
    Referrer-Policy strict-origin-when-cross-origin
  }
}
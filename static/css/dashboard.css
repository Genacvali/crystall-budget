/* ===== iOS-ish tokens ===== */
:root{
  --radius-xl:16px;
  --radius-lg:12px;
  --shadow-soft:0 4px 20px rgba(0,0,0,.06);
  --border:1px solid rgba(0,0,0,.06);
  --surface:#fff;
  --bg:#f5f7fb;
  --text:#0b1220;
  --muted:#6b7280;
  --ok:#22c55e;
  --warn:#f59e0b;
  --bad:#ef4444;
  --info:#0ea5e9;
  --hero-a:#4f46e5;
  --hero-b:#0ea5e9;

  /* единые размеры прогрессов */
  --ff-bar-h:14px;
  --ff-bar-radius:999px;
  --bar-h:14px;
  --bar-radius:999px;
}

/* ===== Темы (мост с Bootstrap) ===== */
[data-bs-theme="light"]{
  --surface:#ffffff;
  --bg:#f5f7fb;
  --text:#0b1220;
  --muted:#6b7280;
  --border:1px solid rgba(0,0,0,.08);
  --shadow-soft:0 6px 20px rgba(0,0,0,.08);

  --bs-body-bg: var(--bg);
  --bs-body-color: var(--text);
  --bs-border-color: rgba(0,0,0,.1);
}
[data-bs-theme="dark"]{
  --surface:#0f141a;
  --bg:#0a0e13;
  --text:#f5f7fb;
  --muted:#a7b0ba;
  --border:1px solid rgba(255,255,255,.08);
  --shadow-soft:0 10px 30px rgba(0,0,0,.5);
}

/* авто по системной теме — безопасный дефолт */
@media (prefers-color-scheme: dark){
  :root{
    --surface:#0f141a;
    --bg:#0a0e13;
    --text:#f5f7fb;
    --muted:#a7b0ba;
    --border:1px solid rgba(255,255,255,.08);
    --shadow-soft:0 10px 30px rgba(0,0,0,.5);
  }
}

/* ===== База ===== */
.page-wrap{ background: var(--bg); }
.page-title{ font-weight:800; letter-spacing:.2px; }
.shadow-soft{ box-shadow: var(--shadow-soft); }
.dropdown-menu{ border-radius:14px; border: var(--border); }

/* ===== Контейнеры ===== */
.card-soft{
  background: var(--surface);
  border: var(--border);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-soft);
}

/* ===== Тумблер темы ===== */
/* === Theme toggle (плавный и без артефактов) === */
[data-bs-theme="light"] #light-icon{ opacity:1; }
[data-bs-theme="dark"]  #dark-icon{  opacity:1; }

.theme-switch{
  --pad: 2px;
  --thumb: 24px;

  position:relative;
  width:56px; height:28px; flex:0 0 56px;
  border-radius:9999px;
  padding:var(--pad);                /* внутренний зазор */
  box-sizing:border-box;
  overflow:hidden;                   /* ничего не торчит */
  cursor:pointer;

  border:1px solid rgba(0,0,0,.18);
  background:#60a5fa1a;             /* fallback */
  background: color-mix(in srgb, #60a5fa 30%, transparent);
  transition: background .2s ease, border-color .2s ease, box-shadow .2s ease;
}

.theme-switch::after{
  content:"";
  position:absolute; top:var(--pad); left:var(--pad);
  width:var(--thumb); height:var(--thumb);
  border-radius:50%;
  background:#fff;
  /* мини-тень без «ореола», чтобы не цеплялась за край */
  box-shadow:0 1px 2px rgba(0,0,0,.28);
  transition: left .2s ease, right .2s ease;
}

/* Dark: трек темнее, шарик «прибит» к правому краю */
[data-bs-theme="dark"] .theme-switch{
  background:#1f2937; border-color:rgba(255,255,255,.12);
}
[data-bs-theme="dark"] .theme-switch::after{
  left:auto; right:var(--pad);      /* ← ключевой приём */
}

/* (опционально) лёгкий обвод в светлой теме для глянца */
[data-bs-theme="light"] .theme-switch{
  box-shadow: inset 0 0 0 1px rgba(59,130,246,.28);
}

/* ===== Segmented control ===== */
.segmented{
  display:inline-flex; align-items:center; gap:2px; padding:2px;
  background: var(--surface); border: var(--border);
  border-radius:999px; box-shadow: var(--shadow-soft);
}
.seg-btn{
  appearance:none; border:0; background:transparent;
  padding:.38rem .75rem; border-radius:999px; color: var(--text); opacity:.9;
}
.seg-btn:hover{ background: rgba(0,0,0,.05); }
[data-bs-theme="dark"] .seg-btn:hover{ background: rgba(255,255,255,.06); }
.seg-divider{ width:1px; height:22px; background: rgba(0,0,0,.07); }
[data-bs-theme="dark"] .seg-divider{ background: rgba(255,255,255,.1); }
.seg-btn.rot180 i{ transform: rotate(180deg); transition: transform .2s ease; }

/* ===== Row для категорий (4 колонки под HTML) ===== */
.cat-row,
.cat-item{
  display:grid;
  grid-template-columns:
    max-content               /* .cat-left  */
    minmax(0, 1fr)            /* .cat-middle */
    max-content               /* .cat-right  */
    max-content;              /* .cat-actions */
  gap:16px; align-items:center; padding:14px 16px;
  background: var(--bs-body-bg);
  border:1px solid var(--bs-border-color);
  border-radius: var(--radius-xl);
}
@media (max-width:992px){
  .cat-row, .cat-item{ grid-template-columns: 1fr 1fr auto; }
}
@media (max-width:576px){
  .cat-row, .cat-item{ grid-template-columns: 1fr; }
  .cat-actions{ flex-direction:row; gap:.5rem; }
}

.cat-title{ font-weight:700; letter-spacing:.2px; }
.cat-meta{ color: var(--muted); font-size:.92rem; margin-top:.2rem; }
.mono, .num .mono{ font-variant-numeric: tabular-nums; }
.muted{ color: var(--muted); }

/* центр-колонка (прогресс) */
.cat-middle{ display:flex; align-items:center; min-width:0; }
.cat-middle .ff-bar{ width:100%; }

/* правая колонка — без переноса и вправо */
.cat-right{ text-align:right; white-space:nowrap; }

/* ===== Прогрессы ===== */
.pill,
.cat-progress,
.progress-line,
.ff-bar{
  position:relative; width:100%;
  height:var(--bar-h); min-height:var(--bar-h);
  border-radius:var(--bar-radius);
  overflow:hidden;
  background: rgba(255,255,255,.10);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.12);
}
[data-bs-theme="light"] .pill,
[data-bs-theme="light"] .cat-progress,
[data-bs-theme="light"] .progress-line,
[data-bs-theme="light"] .ff-bar{
  background: rgba(0,0,0,.08);
  box-shadow: inset 0 1px 1px rgba(0,0,0,.12);
}
.pill-bar,
.cat-progress > i,
.progress-line .fill,
.ff-fill{
  display:block; height:100%; width:0%;
  border-radius:inherit; transition: width .30s ease;
}
.pill-bar.pill-ok,
.cat-progress.ok > i,
.progress-line.ok .fill,
.ff-fill.ok{ background:#22c55e !important; }
.pill-bar.pill-warn,
.cat-progress.warn > i,
.progress-line.warn .fill,
.ff-fill.warn{ background:#f59e0b !important; }
.pill-bar.pill-danger,
.cat-progress.danger > i,
.progress-line.danger .fill,
.ff-fill.danger{ background:#ef4444 !important; }
.pill-bar::after,
.progress-line .fill::after,
.ff-fill::after{ content:none !important; }

/* ===== FF-style прогресс лист ===== */
.cat-row2{
  display:grid; grid-template-columns:1fr minmax(280px,480px) auto;
  gap:1rem; align-items:center; padding:14px 16px;
}
@media (max-width:992px){ .cat-row2{ grid-template-columns:1fr 1fr auto } }
@media (max-width:576px){ .cat-row2{ grid-template-columns:1fr } }

.ff-progress{
  position:relative; height:10px; border-radius:999px; overflow:hidden;
  background: rgba(255,255,255,.12);
  box-shadow: inset 0 1px 2px rgba(0,0,0,.2);
}
[data-bs-theme="light"] .ff-progress{ background: rgba(0,0,0,.08); }
.ff-progress > i{
  display:block; height:100%; width:0%;
  transition: width .35s ease;
  background: linear-gradient(90deg, rgba(255,255,255,.35), rgba(255,255,255,0));
}
.ff-progress.ok > i{ background-color: var(--ok); }
.ff-progress.warn > i{ background-color: var(--warn); }
.ff-progress.danger > i{ background-color: var(--bad); }

/* ===== Кнопки/иконки ===== */
.btn-ghost.icon{
  --_bg:transparent; --_bd:var(--border); --_fg:var(--text);
  display:inline-flex; align-items:center; justify-content:center;
  width:36px; height:36px; border-radius:12px; border: var(--_bd);
  background: var(--_bg); color: var(--_fg); padding:0;
}
.btn-ghost.icon:hover{ background: rgba(255,255,255,.08); }
.btn-ghost.icon.danger:hover{
  background: color-mix(in srgb, var(--bad) 16%, transparent);
  color:#fff; border-color: color-mix(in srgb, var(--bad) 30%, transparent);
}

.ghost-icon{
  border: var(--border); background: transparent; color: var(--muted);
  border-radius: var(--radius-lg); padding:.35rem .5rem;
}
.ghost-icon:hover{ background: rgba(0,0,0,.04); color: var(--text); }
[data-bs-theme="dark"] .ghost-icon:hover{ background: rgba(255,255,255,.06); }

.cat-actions{ display:flex; flex-direction:column; gap:.25rem; }

/* ===== Hero ===== */
.hero{
  background: linear-gradient(135deg, var(--hero-a), var(--hero-b));
  color:#fff; border-radius:20px; padding:20px; position:relative; overflow:hidden;
  box-shadow:0 10px 35px rgba(0,0,0,.3);
}
.hero:before{
  content:""; position:absolute; right:-80px; top:-80px; width:300px; height:300px;
  background: radial-gradient(closest-side, rgba(255,255,255,.2), rgba(255,255,255,0));
  border-radius:50%;
}
.hero h1{ font-size:2rem; font-weight:800; margin:0 0 .25rem; }
.hero .meta{ opacity:.95; }
.btn-hero{
  display:inline-flex; align-items:center; gap:.7rem; color:#fff;
  background: rgba(255,255,255,.15);
  padding:.6rem 1rem; border-radius:16px; font-weight:600;
  border:1px solid rgba(255,255,255,.3);
  backdrop-filter: blur(12px);
  position:relative; overflow:hidden;
  box-shadow: inset 0 0 20px rgba(255,255,255,.1), 0 0 15px rgba(255,255,255,.2);
  transition: transform .2s ease, box-shadow .3s ease; text-decoration:none;
}
.btn-hero:hover{
  transform: translateY(-2px);
  box-shadow: 0 0 20px rgba(255,255,255,.4), 0 0 30px rgba(99,102,241,.5);
  color:#fff; text-decoration:none;
}
.btn-hero::after{
  content:""; position:absolute; top:0; left:-150%; width:50%; height:100%;
  background: linear-gradient(120deg, transparent, rgba(255,255,255,.6), transparent);
  transform: skewX(-20deg); animation: shimmer 3s infinite;
}
@keyframes shimmer{ 100%{ left:150%; } }

/* мелкие утилиты */
.kv{ display:flex; gap:8px; flex-wrap:wrap; }
.kv .k{ opacity:.85; }
.kv .v{ font-weight:700; }
.toast-container{ position:fixed; top:16px; right:16px; z-index:1060; }
.badge-ghost{
  background: rgba(0,0,0,.06); color: var(--text); border-radius:999px;
}
[data-bs-theme="dark"] .badge-ghost{
  background: rgba(255,255,255,.12); color: var(--text);
}
.icon-badge{
  width:34px; height:34px; border-radius:12px; display:grid; place-items:center;
  position:relative; isolation:isolate;
  background: linear-gradient(135deg, rgba(255,255,255,.3), rgba(255,255,255,.1));
  border:1px solid rgba(255,255,255,.5);
  box-shadow: inset 0 0 8px rgba(255,255,255,.4), 0 0 12px rgba(255,255,255,.25);
}
.icon-badge i{ font-size:1.2rem; z-index:1; }
.icon-expense::before,
.icon-income::before{
  content:""; position:absolute; inset:-6px; border-radius:14px; z-index:0;
  filter: blur(12px); opacity:.75;
}
.icon-expense::before{ background: rgba(239,68,68,.8); }
.icon-income::before{ background: rgba(34,197,94,.8); }

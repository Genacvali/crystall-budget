#!/bin/bash
# –°–∫—Ä–∏–ø—Ç –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∞–¥–º–∏–Ω—Å–∫–æ–π –ø–∞–Ω–µ–ª–∏

echo "üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∞–¥–º–∏–Ω—Å–∫–æ–π –ø–∞–Ω–µ–ª–∏..."

# –ü—Ä–æ–≤–µ—Ä—è–µ–º PID —Ñ–∞–π–ª
if [ -f "admin_panel.pid" ]; then
    PID=$(cat admin_panel.pid)
    if kill -0 $PID 2>/dev/null; then
        echo "   –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –ø—Ä–æ—Ü–µ—Å—Å PID: $PID"
        kill $PID
        sleep 2
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –ø—Ä–æ—Ü–µ—Å—Å –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
        if kill -0 $PID 2>/dev/null; then
            echo "   –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–∞—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∞..."
            kill -9 $PID
        fi
        
        echo "‚úÖ –ê–¥–º–∏–Ω—Å–∫–∞—è –ø–∞–Ω–µ–ª—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
    else
        echo "   –ü—Ä–æ—Ü–µ—Å—Å —É–∂–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω"
    fi
    rm -f admin_panel.pid
else
    # –ò—â–µ–º –ø—Ä–æ—Ü–µ—Å—Å –ø–æ –∏–º–µ–Ω–∏
    if pgrep -f "admin_panel/admin_panel.py" > /dev/null; then
        echo "   –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ –ø—Ä–æ—Ü–µ—Å—Å—ã admin_panel/admin_panel.py"
        pkill -f "admin_panel/admin_panel.py"
        echo "‚úÖ –ê–¥–º–∏–Ω—Å–∫–∞—è –ø–∞–Ω–µ–ª—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞"
    else
        echo "   –ê–¥–º–∏–Ω—Å–∫–∞—è –ø–∞–Ω–µ–ª—å –Ω–µ –∑–∞–ø—É—â–µ–Ω–∞"
    fi
fi